<!-- ======================== index.html ======================== -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=0.90, viewport-fit=cover">
  <title>Pick’ems • JZ Fantasy Football</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./pickems.css" />
</head>
<body>
  <div id="app" class="pe-app">
    <header class="site-header">
  <div class="navbar">
    <div class="nav-left">
      <a href="../league.html" class="back-link">← Back to Hub</a>
    </div>
    <h1 class="league-title">Weekly Pick’ems</h1>
    <div class="nav-right">
      <button id="recordsBtn" class="records-btn" type="button" aria-haspopup="dialog" aria-controls="recordsModal">
        Voting Records
      </button>
    </div>
  </div>
</header>

    <!-- Login (replaces Google login) -->
<div class="pe-auth" id="authBox">
  <form id="loginForm" class="pe-login" novalidate>
  <input type="text" id="username" placeholder="Name" required autocomplete="username">
  <input
    type="password"
    id="password"
    placeholder="PIN"
    inputmode="numeric"
    pattern="[0-9]{3}"
    minlength="3"
    maxlength="3"
    title="Enter exactly 3 digits (e.g., 482)"
    required
    autocomplete="one-time-code"
  >
  <button class="pe-btn" type="submit">Login</button>
</form>
  <div id="whoami" class="pe-pill" hidden></div>
  <button id="logoutBtn" class="pe-btn pe-btn-ghost" hidden>Logout</button>
</div>

<!-- Tabs and week views already here -->
<div class="pe-tabs" id="weekTabs"></div>
<div class="pe-weeks" id="weekViews"></div>

<!-- Submit Picks bar -->
<div class="pe-submitbar" id="submitBar">
  <button id="submitPicks" class="pe-btn" disabled>Submit Picks</button>
  <span class="pe-submit-hint" id="submitHint"></span>
</div>

    <nav id="weekTabs" class="pe-tabs" aria-label="Weeks"></nav>

    <main id="weekViews" class="pe-weeks"></main>

    <footer class="pe-footer">
      <small>Built for the PA Milk Society. Data syncs live from Firestore once filled in.</small>
    </footer>
  </div>

  <!-- Firebase and app script -->
  <script type="module">
    
    // Firebase CDN v10 modular imports
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
    import { getFirestore } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-firestore.js";

    // ===== Firebase config =====
    const firebaseConfig = {
        apiKey: "AIzaSyAUk7lfFezJ-pL_-MaDSIoL5RzogPnJw4c",
        authDomain: "ffootball-1ffa4.firebaseapp.com",
        projectId: "ffootball-1ffa4",
        storageBucket: "ffootball-1ffa4.appspot.com",
        messagingSenderId: "214820317243",
        appId: "1:214820317243:web:00907255d3ee230f21541e",
        measurementId: "G-H9LQY4GWSN"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    window.__JZFF__ = { app, auth, db };

    // Simple auth UI
    const authEl = document.getElementById('authStatus');
    const provider = new GoogleAuthProvider();
    function renderAuth(user){
      if(user){
        authEl.innerHTML = `<span class="pe-pill">Signed in as ${user.displayName || user.email}</span><button class="pe-btn pe-btn-ghost" id="logoutBtn">Log out</button>`;
        document.getElementById('logoutBtn').onclick = () => signOut(auth);
      } else {
        authEl.innerHTML = `<button class="pe-btn" id="loginBtn">Sign in with Google</button>`;
        document.getElementById('loginBtn').onclick = () => signInWithPopup(auth, provider);
      }
    }
    onAuthStateChanged(auth, renderAuth);
  </script>

  <script type="module" src="./pickems.js"></script>

  <!-- Voting Records modal -->
<div id="recordsModal" class="records-modal" role="dialog" aria-modal="true" aria-labelledby="recordsTitle" hidden>
  <div class="records-modal-backdrop" data-close="1"></div>
  <div class="records-modal-content" role="document">
    <div class="records-modal-header">
      <h2 id="recordsTitle">Voting Records</h2>
      <button id="recordsClose" class="records-close" aria-label="Close">×</button>
    </div>
    <ol id="recordsList" class="records-list"></ol>
  </div>
</div>

</body>
</html>